# Modern password manager

## Installation

### Productive use

You need a webspace with PHP 7.4.

 1. Extract the ZIP file for the release to your server. Point apache to the folder `public`
 2. Copy the configuration file `.env` to `.env.local` and adjust the contents to your needs.
    You need to at least configure your database:
    ```
    DATABASE_URL=mysql://user:password[@127.0.0.1:3306/database_name?serverVersion=mariadb-10.3.23
    ```
    Also update the APP_SECRET variable to a new random value.
 3. Afterwards run the script bin/console like that:
    ```
    bin/console doctrine:schema:update --force
    ```
    
The password manager only works when you access it through https or on localhost, otherwise current browser do not accept it as secure origin and do not offer the cryptography APIs.

### Docker (only for testing purposes)

 1. run `docker build -t mpm` in the extracted release.
 2. start the container: `docker run --rm -d --name mpm -p 80:80 mpm`
 3. Visit `http://localhostÂ´

Data is stored within the container and not persisted!

## Manual build

### Building React client

 1. Do everything in `reactClient/my-app/`
 2. Use Node 12.x
 3. run `npm install`
 4. run `npm link OpenAPIReactClient/`
 5. run `npm run build`

### Deploying PHP

 1. Copy the whole repository to your server
 2. Go to the `Symfony-API/` directory
 2. Run `composer install --no-dev --no-suggest`.  
    and for apache: `composer require symfony/apache-pack`
 3. Copy the `.env` file to `.env.local` and fill in your database information. Also regenerate `APP_SECRET`.
 4. Prepare the database by running the SQL generated by `php bin/console doctrine:schema:update --dump-sql` in it.
 5. Copy the results of the react-build to `Symfony-API/public/`. Also copy the file `index.html` to `Symfony-API/templates/`.
 6. Configure your webserver with `Symfony-API/public/` as root-directory.
 7. Make sure to use HTTPS, otherwise nothing will work.  
    (This is a restriction by the browsers, the JavaScript APIs in use are only available in a secure context: `https://*` or `localhost`)
 8. Visit your webpage

### Cleaning up

The following files/directories are not needed at runtime:

 - OpenAPIDescription.yaml
 - OpenAPIReactClient/
 - README.md
 - dockerBuild/
 - reactClient/
 - Symfony-API/bin/
